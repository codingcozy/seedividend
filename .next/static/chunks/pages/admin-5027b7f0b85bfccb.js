(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[964],{4830:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return a(9108)}])},7735:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var n=a(7294),_=a(1163);function i(){let e=(0,_.useRouter)(),[t,a]=(0,n.useState)(!1),[i,s]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{e.replace("/"),s(!1)},[e]),{isAuthorized:t,isLoading:i}}},9108:function(e,t,a){"use strict";a.r(t),a.d(t,{__N_SSG:function(){return w},default:function(){return N}});var n=a(5893),_=a(1163),i=a(6853),s=a(3511),l=a.n(s),o=a(7166),c=a.n(o),r=a(2862),d=a(4696),m=a(7294),p=a(1664),h=a.n(p),u=a(7735),f=a(9778),b=a.n(f);let g=c().bind(b());function x(e){let{title:t,onClose:a,children:_}=e,i=(0,m.useRef)(null);return(0,m.useEffect)(()=>{let e=e=>{"Escape"===e.key&&a()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[a]),(0,n.jsx)("div",{className:g("modal-overlay"),children:(0,n.jsxs)("div",{className:g("modal"),ref:i,children:[(0,n.jsxs)("div",{className:g("modal-header"),children:[(0,n.jsx)("h2",{children:t}),(0,n.jsx)("button",{onClick:a,className:g("close-button"),children:"\xd7"})]}),(0,n.jsx)("div",{className:g("modal-content"),children:_})]})})}let j=c().bind(l());var w=!0;function N(e){let{allPosts:t,categoryList:a}=e,s=(0,_.useRouter)();d.px;let[l,o]=(0,m.useState)([]),[c,p]=(0,m.useState)([]),[f,b]=(0,m.useState)(t),[g,w]=(0,m.useState)(!1),[N,v]=(0,m.useState)(!1),[k,y]=(0,m.useState)([]),[E,S]=(0,m.useState)(!1),[C,D]=(0,m.useState)([]),[L,T]=(0,m.useState)(!1),{isAuthorized:A,isLoading:F}=(0,u.Z)(),M=e=>{let t=new Date(e);return"".concat(t.getFullYear(),"-").concat(t.getMonth()+1,"-").concat(t.getDate())},X=e=>{l.includes(e)?o(l.filter(t=>t!==e)):o([...l,e])},P=()=>{l.length===f.length?o([]):o(f.map(e=>e.slug))},R=async e=>{if(window.confirm("정말로 이 포스트를 삭제하시겠습니까?"))try{p(t=>[...t,e]);let t=await fetch("http://localhost:3001/api/delete-post?slug=".concat(e),{method:"DELETE"});if(!t.ok){let e=await t.json();throw Error(e.message||"Failed to delete post")}await t.json(),b(f.filter(t=>t.slug!==e)),l.includes(e)&&o(l.filter(t=>t!==e))}catch(e){console.error("Error deleting post:",e),alert("포스트 삭제 중 오류가 발생했습니다: ".concat(e instanceof Error?e.message:"알 수 없는 오류"))}finally{p(t=>t.filter(t=>t!==e))}},Y=async()=>{if(0===l.length){alert("삭제할 포스트를 선택해주세요.");return}if(window.confirm("선택한 ".concat(l.length,"개의 포스트를 삭제하시겠습니까?"))){let e=0,t=0;for(let a of l)try{p(e=>[...e,a]);let t=await fetch("http://localhost:3001/api/delete-post?slug=".concat(a),{method:"DELETE"});if(!t.ok)throw Error("Failed to delete post");e++,p(e=>e.filter(e=>e!==a))}catch(e){t++,console.error("Error deleting post ".concat(a,":"),e),p(e=>e.filter(e=>e!==a))}b(f.filter(e=>!l.includes(e.slug))),o([]),alert("".concat(e,"개 포스트가 삭제되었습니다. ").concat(t>0?"".concat(t,"개 포스트 삭제 실패."):""))}},G=async()=>{if(window.confirm("블로그를 발행하시겠습니까?"))try{w(!0);let e=await fetch("http://localhost:3001/api/publish-post",{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok){let t=await e.json();throw Error(t.message||"Failed to publish blog")}await e.json(),alert("블로그가 성공적으로 발행되었습니다.")}catch(e){console.error("Error publishing blog:",e),alert("블로그 발행 중 오류가 발생했습니다: ".concat(e instanceof Error?e.message:"알 수 없는 오류"))}finally{w(!1)}},U=e=>c.includes(e),Z=async()=>{try{let e=await fetch("/api/temp-posts");if(!e.ok)throw Error("임시저장 포스트 조회 실패");let t=await e.json();return y(t.posts||[]),t.posts}catch(e){return console.error("임시저장 포스트 목록 조회 오류:",e),[]}},z=e=>{s.push("/admin/create?tempId=".concat(e))},H=async(e,t)=>{if(e.stopPropagation(),window.confirm("이 임시저장 포스트를 삭제하시겠습니까?"))try{D(e=>[...e,t]);let e=await fetch("/api/temp-post/".concat(t),{method:"DELETE"});if(!e.ok)throw Error("임시저장 포스트 삭제에 실패했습니다.");y(e=>e.filter(e=>e.id!==t))}catch(e){console.error("임시저장 포스트 삭제 오류:",e),alert("임시저장 포스트를 삭제하는 중 오류가 발생했습니다.")}finally{D(e=>e.filter(e=>e!==t))}},I=async()=>{if(0===k.length){alert("삭제할 임시저장 포스트가 없습니다.");return}if(window.confirm("모든 임시저장 포스트(".concat(k.length,"개)를 삭제하시겠습니까?")))try{T(!0);let e=await fetch("/api/temp-posts/delete-all",{method:"DELETE"});if(!e.ok)throw Error("임시저장 포스트 전체 삭제에 실패했습니다.");let t=await e.json();y([]),alert(t.message||"".concat(t.deletedCount,"개의 임시저장 포스트가 삭제되었습니다."))}catch(e){console.error("임시저장 포스트 전체 삭제 오류:",e),alert("임시저장 포스트를 삭제하는 중 오류가 발생했습니다.")}finally{T(!1)}},K=e=>C.includes(e),O=()=>{S(!0),console.log("Test"),Z().then(()=>{v(!0)}).catch(e=>{console.error("임시저장 포스트 조회 실패:",e),s.push("/admin/create")}).finally(()=>{S(!1)})};return F?(0,n.jsx)("div",{children:"Loading..."}):A?(0,n.jsx)(n.Fragment,{children:s.isFallback?" Loading…":(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.Z,{type:"home"}),(0,n.jsxs)("div",{className:j("container","-list"),children:[(0,n.jsx)(i.Z,{postList:f,categoryList:a}),(0,n.jsxs)("div",{className:j("inner"),children:[(0,n.jsxs)("div",{className:j("admin_actions"),children:[(0,n.jsx)("button",{onClick:G,className:j("publish_btn"),disabled:g,children:g?"발행 중...":"발행"}),(0,n.jsx)("button",{onClick:O,className:j("create_btn"),children:"새 포스트 작성"}),l.length>0&&(0,n.jsxs)("button",{className:j("bulk_delete_btn"),onClick:Y,disabled:c.length>0,children:["선택한 포스트 삭제 (",l.length,")"]})]}),(0,n.jsxs)("div",{className:j("post_list_header"),children:[(0,n.jsx)("div",{className:j("checkbox_cell"),children:(0,n.jsx)("input",{type:"checkbox",checked:l.length===f.length&&f.length>0,onChange:P})}),(0,n.jsx)("div",{className:j("title_cell"),children:"제목"}),(0,n.jsx)("div",{className:j("actions_cell"),children:"작업"})]}),(0,n.jsx)("div",{className:j("post_list"),children:f.map(e=>(0,n.jsxs)("div",{className:j("post_item"),children:[(0,n.jsx)("div",{className:j("checkbox_cell"),children:(0,n.jsx)("input",{type:"checkbox",checked:l.includes(e.slug),onChange:()=>X(e.slug),disabled:U(e.slug)})}),(0,n.jsxs)("div",{className:j("title_cell"),children:[(0,n.jsx)(h(),{href:"/post/".concat(e.slug),className:j("title_link"),children:e.title}),(0,n.jsxs)("div",{className:j("post_meta"),children:[(0,n.jsx)("span",{className:j("post_category"),children:d.En[e.category]}),(0,n.jsx)("span",{className:j("separator"),children:"•"}),(0,n.jsx)("span",{className:j("post_date"),children:M(e.date)})]})]}),(0,n.jsxs)("div",{className:j("actions_cell"),children:[(0,n.jsx)("button",{className:j("action_btn","edit"),onClick:()=>s.push("/admin/edit/".concat(e.slug)),disabled:U(e.slug),children:"수정"}),(0,n.jsx)("button",{className:j("action_btn","delete"),onClick:()=>R(e.slug),disabled:U(e.slug),children:U(e.slug)?"삭제 중...":"삭제"})]})]},e.slug))}),0===f.length&&(0,n.jsx)("div",{className:j("no_posts"),children:"포스트가 없습니다."})]})]}),N&&(0,n.jsx)(x,{onClose:()=>v(!1),title:"임시저장된 포스트",children:E?(0,n.jsxs)("div",{className:j("loading_spinner"),children:[(0,n.jsx)("div",{className:j("spinner")}),(0,n.jsx)("p",{children:"임시저장 포스트를 불러오는 중..."})]}):k&&k.length>0?(0,n.jsxs)("div",{className:j("temp_post_list"),children:[(0,n.jsx)("p",{className:j("temp_post_guide"),children:"계속해서 작성하실 임시저장 포스트를 선택하거나, 새로 작성하실 수 있습니다."}),(0,n.jsx)("div",{className:j("temp_post_wrap"),children:k.map(e=>(0,n.jsxs)("div",{className:j("temp_post_item"),onClick:()=>z(e.id),children:[(0,n.jsxs)("div",{className:j("temp_post_content"),children:[(0,n.jsx)("h3",{className:j("temp_post_title"),children:e.title}),(0,n.jsx)("p",{className:j("temp_post_date"),children:new Date(e.date).toLocaleString()})]}),(0,n.jsx)("button",{className:j("temp_delete_btn"),onClick:t=>H(t,e.id),disabled:K(e.id),children:K(e.id)?"삭제 중...":"삭제"})]},e.id))}),(0,n.jsxs)("div",{className:j("temp_action_buttons"),children:[(0,n.jsx)("button",{className:j("delete_all_btn"),onClick:I,disabled:L,children:L?"삭제 중...":"전체 삭제"}),(0,n.jsx)("button",{className:j("new_post_btn"),onClick:()=>{v(!1),s.push("/admin/create")},children:"새로 작성하기"})]})]}):(0,n.jsxs)("div",{className:j("no_temp_posts"),children:[(0,n.jsx)("p",{children:"임시저장된 포스트가 없습니다."}),(0,n.jsx)("button",{className:j("new_post_btn"),onClick:()=>{v(!1),s.push("/admin/create")},children:"새로 작성하기"})]})})]})}):(0,n.jsx)("div",{children:"Unauthorized access"})}},9778:function(e){e.exports={"modal-overlay":"Modal_modal-overlay__bs7XG",modal:"Modal_modal__2Aj4i","modal-header":"Modal_modal-header__qukIe"}},3511:function(e){e.exports={post_content:"admin_post_content__ft_Pe",container:"admin_container__sDpJg","-list":"admin_-list__X_bjD",inner:"admin_inner__jN_HH",project_list:"admin_project_list__OuNd9",ifram_wrap:"admin_ifram_wrap__aU42G",iframe:"admin_iframe__NLBq7",meta:"admin_meta__L_vxo",date:"admin_date__la_NA",post_meta:"admin_post_meta__U_4y9",post_category:"admin_post_category__QaYM3",separator:"admin_separator__vyCi5",profile_wrap:"admin_profile_wrap__EVWVv",profile_image_wrap:"admin_profile_image_wrap__XAo1n",textarea:"admin_textarea__bh9P0",info:"admin_info__2trzw",reading_time:"admin_reading_time__Xpbe3",post_title:"admin_post_title__J_A2i",tag_area:"admin_tag_area__FvAZM",tag:"admin_tag__9Px2L",view_badge:"admin_view_badge__utAag",post_list_header:"admin_post_list_header__Q_fWD",post_list:"admin_post_list__djSuc",post_item:"admin_post_item__pwAj9",checkbox_cell:"admin_checkbox_cell__HiARW",title_cell:"admin_title_cell___XYsg",title_link:"admin_title_link__DA8PM",actions_cell:"admin_actions_cell__4oldf",action_btn:"admin_action_btn__TA3_2",edit:"admin_edit__euMYR",delete:"admin_delete__r3NKS",view:"admin_view__M5heO",share:"admin_share__guXKz",admin_actions:"admin_admin_actions__yn899",create_btn:"admin_create_btn__R59bD",bulk_delete_btn:"admin_bulk_delete_btn__B0TwG",no_posts:"admin_no_posts__UxSux",admin_header:"admin_admin_header__yDNef",admin_title:"admin_admin_title__SejFK",back_btn:"admin_back_btn__gQ1ni",create_form_container:"admin_create_form_container__NpHZ8",post_form:"admin_post_form__eFezp",form_group:"admin_form_group__MYnWL",form_label:"admin_form_label__gd9oB",form_input:"admin_form_input__K3kki",form_select:"admin_form_select__X7DDt",form_textarea:"admin_form_textarea__6i55x",form_actions:"admin_form_actions__JHbQA",cancel_btn:"admin_cancel_btn__y2MwJ",submit_btn:"admin_submit_btn__weIP_",error_message:"admin_error_message__2Gg_u",publish_btn:"admin_publish_btn__0ypl_",loading_spinner:"admin_loading_spinner__wrQY4",spinner:"admin_spinner__BqN3h",spin:"admin_spin__UgVYr",temp_post_list:"admin_temp_post_list__yqAln",temp_post_guide:"admin_temp_post_guide__A1IGR",temp_post_wrap:"admin_temp_post_wrap__7bK0z",temp_post_item:"admin_temp_post_item__YWkFy",temp_post_content:"admin_temp_post_content__owSRn",temp_post_title:"admin_temp_post_title__ozHfg",temp_post_date:"admin_temp_post_date___qvTO",temp_post_preview:"admin_temp_post_preview__laeKm",temp_delete_btn:"admin_temp_delete_btn__rZ658",temp_action_buttons:"admin_temp_action_buttons__ThGFy",delete_all_btn:"admin_delete_all_btn__IITVt",new_post_btn:"admin_new_post_btn__oU8XU",no_temp_posts:"admin_no_temp_posts__bDfQr"}}},function(e){e.O(0,[564,526,774,888,179],function(){return e(e.s=4830)}),_N_E=e.O()}]);
//# sourceMappingURL=admin-5027b7f0b85bfccb.js.map