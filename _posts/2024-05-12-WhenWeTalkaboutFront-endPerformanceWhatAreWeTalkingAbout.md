---
title: "프론트엔드 성능에 대해 이야기할 때, 우리는 무엇을 얘기하고 있는 걸까요"
description: ""
coverImage: "/assets/img/2024-05-12-WhenWeTalkaboutFront-endPerformanceWhatAreWeTalkingAbout_0.png"
date: 2024-05-12 23:59
ogImage: 
  url: /assets/img/2024-05-12-WhenWeTalkaboutFront-endPerformanceWhatAreWeTalkingAbout_0.png
tag: Tech
originalTitle: "When We Talk about Front-end Performance, What Are We Talking About"
link: "https://medium.com/gitconnected/when-we-talk-about-front-end-performance-what-are-we-talking-about-4efb8d2389af"
---


<img src="/assets/img/2024-05-12-WhenWeTalkaboutFront-endPerformanceWhatAreWeTalkingAbout_0.png" />

이 기사에서는 Google의 공식 도구 라이트하우스를 활용하여 최신 프런트엔드 페이지 성능 평가 표준을 분석하여 다양한 성능 지표를 이해하고 관련 프런트엔드 프로젝트를 개선하고 최적화하는 데 도움을 줍니다.

프런트엔드 페이지 성능은 사용자 유지율이 페이지 로드 성능과 밀접한 연관이 있기 때문에 모두에게 항상 연속적인 관심사였습니다. 구글의 데이터 통계에 따르면, 페이지 방문 시간이 1초에서 3초로 증가할 때 사용자의 이탈률이 32% 증가합니다.

프런트엔드 페이지 성능을 평가하는 두 가지 방법이 일반적으로 있습니다: 하나는 성능 분석 도구를 사용하여 온라인에서 다양한 지표를 점수화하고 평가하는 것이며, 다른 하나는 성능 모니터링을 사용하여 Performance API나 사용자의 실제 네트워크 액세스 상황을 보고한 후 통계 분석을 수행하는 것입니다.



사용자 데이터를 통계적으로 수집하는 것이 더 현실적이지만 페이지 성능 평가에 대한 통일된 양적 기준을 갖기 위해 종종 페이지 성능을 평가하는 데 표준 평가 도구를 사용하기로 선택합니다.

성능 분석 초기 단계에서는 Chrome 개발자 도구를 사용하여 웹 페이지를 분석하며, 로드 및 DOMContentLoaded와 같은 이벤트가 발생하는 시간을 확인합니다. 나중에 Webpage Analyzer, WebPageTest, YSlow 등과 같은 일련의 성능 분석 도구가 등장했습니다.

이제 Google은 자체 개발한 Lighthouse를 공식적으로 개발자 도구 탭에 내장시켰으므로, Lighthouse를 표준 평가 도구로 고려합니다.

Lighthouse는 페이지의 최상의 사례에 관한 관련 권고 사항을 제공하는 오픈 소스 웹 페이지 성능 분석 도구입니다. Chrome DevTools에서 직접 사용할 수도 있을 뿐만 아니라 브라우저 확장 프로그램(Chrome 및 Firefox)이나 npm 패키지(Node API 또는 CLI)도 지원합니다.



Google의 Web Measure 및 PageSpeed Insight와 같은 도구는 페이지를 분석하는 라이트하우스를 사용합니다.

## 1. 라이트하우스의 반복 및 성능 지표 변경

라이트하우스의 최초 오픈 소스 버전은 2016년으로 거슬러 올라가며, 2020년 10월 기준 최신 버전은 6.4.1이며, 총 89번의 반복을 거쳤습니다. 이들 몇 년 사이에, 라이트하우스는 성능 메트릭스(지표)를 업데이트해 왔습니다.

최신 버전 6.X에서 Google은 5.X 버전과 비교해 세 가지 새로운 성능 메트릭스를 소개했습니다: FMP(첫 의미 있는 그림 렌더링), FCI(첫 CPU 비활성 및 mpFID(최대 잠재 첫 입력 지연)가 제거되었습니다.



TBT (Total Blocking Time), LCP (Largest Contentful Paint), and CLS (Cumulative Layout Shift)가 추가되었습니다. 다음 섹션에서는 이러한 지표들에 대한 자세한 설명을 제공할 것입니다.

![image](/assets/img/2024-05-12-WhenWeTalkaboutFront-endPerformanceWhatAreWeTalkingAbout_1.png)

## 2. 페이지 성능 점수 계산 방법

아래 그림에서 보듯이, 페이지 성능 섹션에서 Lighthouse는 6가지 주요 지표의 성능을 평가하고 페이지의 성능 점수를 계산할 것입니다.



![표](/assets/img/2024-05-12-WhenWeTalkaboutFront-endPerformanceWhatAreWeTalkingAbout_2.png)

최신 6.X 계산 방법에 따르면 각 성능 메트릭은 점수에 대응됩니다. 예를 들어, 위 그림에서 FCP, SI, LCP, TTI, TBT 및 CLS의 값은 각각 78, 62, 37, 5, 99, 92에 해당하는 개별 점수입니다. 일반적으로 메트릭 값이 작을수록 해당하는 점수가 높습니다.

이 여섯 메트릭에 할당된 가중치는 각각 15%, 15%, 25%, 15%, 25%, 5%입니다. 전체 성능 점수는 가중 평균을 통해 60점으로 계산됩니다.

각 메트릭 값이 해당하는 점수 계산 방법은 이 기사 끝에 있는 참고 자료 번호 다섯와 여섯에서 자세히 확인할 수 있습니다.



라이트하우스 v6.0.에서는 FMP (First Meaningful Paint), FCI (First CPU Idle) 및 mpFID (Maximum Potential First Input Delay)와 같은 세 가지 핵심 성능 지표가 제거되었습니다.

현재 버전이 그들의 메트릭을 선택하는 방식을 더 잘 이해하기 위해 이 세 가지 폐기된 지표의 정의를 살펴보겠습니다.

## 1. FMP란 무엇이며 FCP와 어떤 차이가 있는가?

FMP에 대해 이야기할 때에는 먼저 First Contentful Paint (FCP)를 소개해야 합니다: 첫 번째 콘텐츠 렌더링 시간입니다.



위에서 언급한 대로, 브라우저가 처음으로 'First Page Paint' 이벤트를 트리거하면, 이 순간이 FCP가 됩니다. 하지만, 이때 렌더링되는 내용이 반드시 중요한 페이지 정보일 필요는 없습니다. 예를 들어, 헤더 액션바를 그리거나 심지어 가시적인 요소만 렌더링되는 경우도 있을 수 있습니다. Lighthouse 6.0에는 여전히 포함되어 있지만, 성능 점수에서의 비중은 23%에서 15%로 감소했습니다.

그러므로, FCP는 사용자 관점에서 페이지 성능을 정확히 판단할 수 있는 지표로 사용할 수 없습니다.

이 맥락에서 'FMP (First Meaningful Paint)'이 등장했습니다. 공식적인 정의에 따르면, FMP는 페이지 로딩이 시작된 후 초기 화면에 가장 많거나 주요 콘텐츠가 렌더링된 시점을 말합니다.

그렇다면, FMP 타이밍은 어떻게 확인할까요? 먼저 가장 기본적인 계산 방법을 살펴보겠습니다:



먼저 레이아웃 오브젝트의 수를 계산합니다 (테스트 계산을 위해 LayoutAnalyzer를 사용하십시오; 참조 17번을 참조하십시오).

아래 그림에서 볼 수 있듯이 페이지 로딩 프로세스는 레이아웃 오브젝트가 레이아웃 트리로 점진적으로 들어가고 렌더링되는 과정입니다.

![이미지](/assets/img/2024-05-12-WhenWeTalkaboutFront-endPerformanceWhatAreWeTalkingAbout_3.png)

layoutAnalyzer는 레이아웃 오브젝트의 수를 모으고, LayoutObjectsThatHadNeverHadLayout라는 카운터로 새로 추가된 레이아웃 오브젝트의 수를 나타냅니다.



테스트를 통해 다른 카운터와 비교했을 때, 가장 변화가 많이 일어나는 순간은 종종 페이지에서 가장 중요한 요소들이 렌더링될 때입니다.

따라서 FMP 지표의 계산 방법은 LayoutObjectsThatHadNeverHadLayout(새롭게 추가된 레이아웃 오브젝트)가 가장 큰 변화를 경험한 다음 순간입니다(가장 큰 레이아웃 변경을 따라오는 페인트).

물론, 위의 상황이 적용되지 않는 몇 가지 시나리오도 있습니다:

a) 페이지가 긴 경우, 첫 화면 내에는 가시적인 레이아웃 오브젝트보다 보이지 않는 레이아웃 오브젝트가 더 많이 추가될 수 있습니다. 이 경우에는 FMP가 부정확해집니다.



b) 웹 폰트를 로드하고 텍스트가 레이아웃을 위해 대체 글꼴을 사용하지만 로드 시작으로부터 3초 내에 그려지지 않는 경우; 이는 또한 FMP 계산에 영향을 줄 수 있습니다.

시나리오 1의 경우, FMP는 이 문제를 해결하기 위해 "레이아웃 중요성" 개념을 도입했습니다; 시나리오 2의 경우, FMP는 통계를 지연시켜 지표가 페이지 상태를 더 정확하게 반영하도록 합니다. 자세한 해결책은 참조문헌 18을 참조해 주세요.

그러나 FMP는 주요하게 다음 두 가지 이유로 버전 6.0에서 폐기되었습니다.

- 실제 환경에서 FMP는 페이지의 작은 변경에 너무 민감하여 일관되지 않은 결과로 쉽게 이어질 수 있습니다.
- 이 지표의 정의는 브라우저의 구체적인 구현 세부 사항에 심하게 의존하며 참조를 위한 표준화가 부족합니다.



# 2. LCP가 FMP를 대체하고 나타났어요

이전 섹션에서 FCP와 FMP의 단점을 언급했었는데요, 그래서 W3C의 성능 그룹은 페이지의 주요 콘텐츠를 사용자가 볼 수 있는 시간을 더 정확하게 반영하는 적절한 지표를 찾고 있었어요.

가끔은 더 간단할수록 더 좋아요. 다양한 소스에서의 토론을 토대로 페이지 성능에 관한 보다 정확한 측정 방법, 즉 LCP (가장 큰 콘텐츠 렌더링)가 마침내 찾아졌어요.

LCP는 뷰포트 내에서 가장 큰 콘텐츠 요소가 렌더링되는 시간을 의미해요. 이 지표는 Lighthouse 6.0에서 공식적으로 소개되었으며 최종 성능 점수에서 25%의 가중치를 갖고 있어요.



LCP는 FCP와 함께 정의하기 가장 쉬운 메트릭 중 하나여야 합니다. 그 정의에는 비교할 요소 선택과 그 크기를 결정하는 두 가지 중요한 요소가 있습니다.

공식 문서에 따르면, 다음 요소들이 가장 큰 콘텐츠 요소(Largest Contentful Element)의 일부로 고려될 것입니다:

- `img`
- `svg` 내부의 `image`
- `video`
- url() 함수를 통해 배경 이미지를 로드하는 요소
- 텍스트 노드를 포함하거나 인라인 텍스트 자식 요소를 포함하는 블록 수준의 요소들

요소의 크기를 어떻게 결정할까요? 주로 다음 네 가지 규칙에 기반하여 결정됩니다:



- 화면 뷰포트 내에서 보이는 요소의 크기; 뷰포트를 벗어나거나 가려지거나 가려지거나 감춰진 경우 크기로 계산되지 않습니다.
- 이미지 요소의 경우 크기는 실제 크기와 원래 크기 중 작은 것을 취함으로 결정됩니다.
- 텍스트 요소의 경우 모든 텍스트를 덮는 최소 직사각형 영역만을 고려합니다.
- 모든 요소의 경우 여백, 안쪽 여백, 테두리 등은 계산에 포함되지 않습니다.

구글은 이 메트릭을 다음과 같이 평가합니다: LCP는 매우 중요한 사용자 중심 지표이며 사용자 수준에서 지각된 로딩 속도를 반영합니다. 주요 콘텐츠에서 가장 큰 콘텐츠 요소의 로딩이 완료된 것을 나타내며, 더 짧은 LCP 시간으로 사용자는 페이지를 더 빠르게 사용 가능하다고 인식하게 됩니다.

# 3. 버려진 FCI와 TTI와 왜 밀접한 관련이 있는가?

FCI(First CPU Idle: 첫 번째 CPU 대기)는 페이지가 최소 상호 작용 표준에 도달하는 데 얼마나 오래 걸리는지를 측정하는 메트릭입니다.



최소 상호 작용성의 확인을 위해서는 다음 두 가지 조건을 동시에 충족해야 합니다:

a) 화면에 있는 대부분의 UI 요소가 상호 작용 가능해야 합니다

b) 페이지가 일반적으로 합리적인 범위 내에서 사용자 입력에 응답해야 합니다

TTI (Time To Interactive: 페이지 상호 작용까지의 시간)는 페이지가 완전히 상호 작용 가능한 상태에 도달하는 데 필요한 시간을 의미합니다.



"완전 대화형"이란 다음 세 가지 조건을 모두 충족하는 것을 의미합니다:

a) FCP 이후 페이지에 유용한 콘텐츠가 렌더링되었습니다

b) 가장 눈에 띄는 페이지 요소에 이벤트 콜백이 등록되었습니다

c) 사용자 상호작용에 대한 페이지 응답 시간이 50ms 이내입니다



2017년에 첫 번째 상호 작용 메트릭이 두 가지 메트릭, 즉 첫 상호 작용 및 일관적 상호 작용으로 나뉘었으며, 이어지는 해의 7월에 첫 상호 작용은 FCI로 변경되었고, 일관적 상호 작용은 TTI로 변경되었습니다. FCI와 TTI는 사용자 상호 작용 응답을 반영하는 두 가지 메트릭임을 볼 수 있습니다.

그렇다면 최소 상호 작용 및 전체 상호 작용은 어떻게 계산되는 걸까요? 구체적인 계산 방법을 소개하기 전에 이 두 가지 메트릭이 모호하며 서로 다른 상황에서 계속 최적화되고 개선될 수 있다는 것을 알아야 합니다.

- FCI의 최소 상호 작용 시간

주 스레드의 타임라인에서 FMP부터 특정 작업이 끝난 후까지 길이가 f(t)인 시간 창 W를 찾습니다. W가 해당 기간 동안 어떤 지점에서도 250ms 이상의 연속적인 작업 집합이 없고, 그 끝과 직전 1초 내에 JS 실행 시간이 50ms를 초과하는 긴 작업이 없으면 해당 작업이 끝난 시점이 우리가 정의하는 FCI입니다. 여기서 f(t)=4e^(-0.045t)+1.



아래 그림에서 빨간 상자로 표시된 지점이 FCI를 나타냅니다.

![FCI](/assets/img/2024-05-12-WhenWeTalkaboutFront-endPerformanceWhatAreWeTalkingAbout_4.png)

- TTI: 완전 상호 작용 시간

네트워크 및 주 스레드의 타임라인에서 처음 5초 창기간 W을 찾으세요. W 기간 내에서 다음 조건을 충족해야 합니다: 어떤 순간에도 동시 네트워크 요청이 최대 두 개이고 50ms를 초과하는 긴 작업이 없습니다. W 이전의 마지막 긴 작업의 종료 시간을 TTI로 지칭합니다.



아래 그림에서 빨간 상자로 표시된 시점은 TTI입니다:

![Figure](/assets/img/2024-05-12-WhenWeTalkaboutFront-endPerformanceWhatAreWeTalkingAbout_5.png)

일부 사람들은 FCI가 특정 시기에 TTI보다 의미가 더 있다고 지적했지만, 이들 사이의 차이는 여전히 라이트하우스가 두 가지 유사한 메트릭을 유지하는 것을 정당화하는데 충분하지 않습니다.

그래서 라이트하우스 버전 6.0에서 최종 결정이 내려져 FCI 대신 TTI를 사용하기로 결정되었습니다.



# 4. mpFID 및 새로 추가된 TBT 지표

mpFID (최대 잠재적 첫 입력 지연)은 사용자 입력부터 페이지에서 이벤트 콜백을 처리하기 시작하는 실제 시간까지의 잠재적 최대 지연 시간을 나타냅니다.

mpFID의 구체적인 계산 방법은 FCP부터 TTI까지의 JavaScript 실행 시간을 기준으로 가장 긴 작업을 선택한 다음 해당 작업이 소비한 시간에서 50ms를 뺀 것입니다.

그러나 mpFID는 최대 지연 시간만을 나타내며, 사용자가 경험하는 실제 지연 시간과 다를 수 있습니다. 사용자가 다른 시간에 얻는 FID도 다를 수 있습니다. 따라서 mpFID는 페이지의 응답 시간을 사용자 입력에 대한 실제 반응 시간을 정확하게 반영하지 않습니다.



5. X 버전에서 성능 점수를 계산할 때 mpFID는 가중치가 0으로 설정되어 점수에 기여하지 않습니다. 이 메트릭은 이제 더 이상 보고서에 나타나지 않지만, JSON 데이터에는 유지되며 공식적으로 인정받는 핵심 사용자 경험 지표로 남아 있습니다.

그렇다면 TBT (Total Blocking Time)은 정확히 무엇이며 왜 성능 보고서에서 FID 대신 선택해야 하는 것인가요?

먼저 정의를 살펴보겠습니다: TBT는 페이지에서 사용자 입력에 응답할 때 차단된 총 누적 시간을 의미합니다.

구체적인 계산 방법은 매우 명확합니다 — FCP와 TTI 사이의 모든 긴 작업을 합산하고 그 차단 부분의 시간을 추가하여 TBT를 얻습니다. 차단 부분의 시간이란 긴 작업 실행 시간이 50ms를 초과하는 부분을 말합니다; 예를 들어, 긴 작업이 전체 70ms 걸리면 차단된 시간은 20ms가 됩니다.



mpFID과 비교해 볼 때 TBT는 사용자 입력에 대한 페이지의 평균 지연 응답을 더 정확하게 반영할 수 있는 더 안정적인 지표입니다.

## 5. 최근 추가된 CLS

CLS (Cumulative Layout Shift)는 시각적 인터페이스의 안정성을 측정하는 지표입니다.

데이터는 레이아웃 불안정성 API(참조 14 참조)에서 얻으며, 계산 방법은 다음과 같습니다:




레이아웃 이동 점수 = 영향 분수 * 거리 분수

영향 분수는 전체 뷰포트에 미치는 영향 정도를 나타냅니다. 예를 들어 아래 이미지에서 텍스트가 전체 뷰포트의 50%를 차지하고 다음 프레임에서 이전 프레임 대비 25% 아래로 이동한다면 전체 페이지의 75%에 영향을 줍니다. 따라서 영향 분수는 0.75입니다.

![이미지](/assets/img/2024-05-12-WhenWeTalkaboutFront-endPerformanceWhatAreWeTalkingAbout_6.png)

거리 분수는 비교적 이해하기 쉽습니다. 전체 뷰포트의 변경된 거리 비율을 의미합니다. 예를 들어 위 경우에서 25% 이동은 거리 분수가 0.25를 의미합니다.



그래서, 그림으로 설명된 데모의 CLS 값은 0.75 * 0.25 = 0.1875로 계산됩니다. 더 자세한 계산 방법은 참고문헌 13과 14에서 확인할 수 있습니다.

CLS가 사용자 경험에 미치는 영향을 설명하는 예시: 아래 다이어그램과 같이 사용자가 취소 버튼을 클릭하려고 할 때, 갑자기 페이지에서 레이아웃이 변경되어 취소 버튼이 있던 자리에 확인 버튼이 나타납니다...

![다이어그램 이미지](/assets/img/2024-05-12-WhenWeTalkaboutFront-endPerformanceWhatAreWeTalkingAbout_7.png)

CLS는 사용자 중심의 새로운 성능 평가 지표임을 알 수 있습니다.



현재 CLS는 새로 추가된 지표로, 가중치가 5%뿐입니다. 하지만 Lighthouse는 다음 주요 버전에서 해당 가중치를 늘릴 계획이라고 합니다.

## 6. 항상 사용되던 속도 지수

속도 지수(Speed Index, SI)는 페이지에서 보이는 내용이 채워지는 속도를 측정하는 데 사용됩니다. 계산 과정은 오픈 소스 도구인 Speedline(참고 문헌 16)을 사용합니다.

Speedline은 페이지의 비디오를 기록하고 첫 프레임과 마지막 프레임 사이의 시간 차이를 측정하여 속도 지수의 값을 계산합니다.



SI의 최종 점수는 데이터베이스에 있는 실제 웹 사이트의 SI 값과 비교하여 계산됩니다. 현재 SI 점수와 평가 기준은 아래 표에 표시되어 있습니다:

| 항목 | 점수 |
|:--:|:--:|
| FMP to LCP | X |
| FCI to TTI | Y |
| FID to TBT | Z |

위 지표들의 교체 과정을 검토하면, 성능 지표의 선택은 모두 더욱 안정적인 방향으로 나아가고 있음을 알 수 있습니다: 지표의 정의가 더욱 간결하고 명확해지고, 계산 방법 또한 표준화되는 방향으로 발전하고 있습니다.

하지만 우리는 여기에 완벽한 해결책이 없다는 것을 알아야 합니다; 각 지표에는 한계가 있습니다. 많은 상황에서 낮은 점수가 반드시 페이지 경험의 품질이 나쁘다는 것을 의미하지는 않습니다. 성능 점수에 기반하여 페이지를 더 과학적으로 평가하기 위해서는 이러한 지표들 뒤의 원칙을 이해해야 합니다.



성능 관련 기술의 신속한 변화로 이 문서에 빠뜨린 부분이 있을 경우 언제든지 의사 소통하여 수정해 주시기 바랍니다.

- 새로운 산업 기준에 맞는 모바일 페이지 속도를 찾아보세요.
- Performance.timing API
- Lighthouse 6.0의 새로운 기능
- Web Vitals
- Lighthouse 점수 산출기
- Lighthouse 성능 점수
- WebPageTest 데모
- 첫 의미 있는 페인트까지의 시간
- 첫 상호작용 및 일관된 상호작용
- 가장 큰 콘텐츠 페인트 (LCP)
- 첫 상호작용 및 일관된 상호작용
- Mercado Libre가 Web Vitals (TBT/FID)을 최적화한 방법
- 누적 레이아웃 이동 (CLS)
- 레이아웃 불안정성
- 속도 지수
- 속도 라인
- 레이아웃 분석기
- 첫 의미 있는 페인트까지의 시간