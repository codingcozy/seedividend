---
title: "env 파일 이제는 그만 둘 때  더 나은 대안 찾기"
description: ""
coverImage: "/assets/img/2024-06-23-Itstimetodeprecatetheenvfile_0.png"
date: 2024-06-23 13:05
ogImage: 
  url: /assets/img/2024-06-23-Itstimetodeprecatetheenvfile_0.png
tag: Tech
originalTitle: "It’s time to deprecate the .env file"
link: "https://medium.com/@tony.infisical/its-time-to-deprecate-the-env-file-for-a-better-stack-a519ac89bab0"
---


<img src="/assets/img/2024-06-23-Itstimetodeprecatetheenvfile_0.png" />

반년마다 우리는 개발자들이 환경 변수를 관리하고 .env 파일을 사용해야 하는지에 대해 논의합니다. 이 논의는 주로 개발자들이 .env 파일 또는 기타 방법 또는 시크릿 매니저를 사용하여 환경 변수를 관리해야 하는지에 대한 것입니다. 짜증난 트윗부터 비디오와 블로그까지 많은 증거가 있어 보여주지만 많은 개발자들이 최적의 방법에 동의할 수 없다는 것을 나타낸다.

명확히 말하자면, 나의 입장은 항상 "적합한 도구가 있다"는 것입니다. 간단하거나 샌드박스용 경우에는 .env 파일을 사용하는 것을 고려할 수 있습니다. 그러나 진지한 조직은 시크릿 매니저를 사용하여 전체 인프라 스택 및 개발 주기 전체에 걸쳐 변수를 효율적으로 관리하고 자동화해야 한다고 생각합니다. 이는 그들의 스택에서 .env 파일을 폐기하는 것을 의미합니다.

# .env에 대한 내 의견은 무엇인가요?

<div class="content-ad"></div>

.env 파일을 사용하는 접근 방식은 zuverlässigekeit(신뢰성) 및 보안과 관련된 상당한 결함을 가지고 있다고 생각하지만 여기에서 자세히 설명하는 것과는 별개로, 이를 계속해서 사용하여 오래된, 부실한 개념을 앞세우는 데 대해 더 큰 문제를 느낍니다. 특히 클라우드 네이티브 컴퓨팅 시대를 고려할 때, 우수한 도구를 대면하여 오래된 개념을 보급하는 것은 더욱 부적절합니다. 요즘에는 각 소프트웨어 인프라 수직으로 필요한 목적에 맞는 도구가 있으므로, 오래된, 오류가 발생하기 쉬우며 비효율적인 방식을 대체하기 위한 새로운 산업 표준을 배우고 채택해야 합니다.

.env가 오래된 이유는 인프라와 개발 주기의 차이점 때문이라고 생각합니다. 적어도 현재처럼 확장성이 더 낮고 넓어진 환경이 아니었다고 주장할 수 있습니다. 그런 "단순한" 컴퓨팅 환경에서 이러한 구성 파일을 사용하는 것이 더 타당했었습니다. 이 이유로, 나는 후에 더 설명할 것을 생각해도 간단한 사용 사례를 위해 .env 파일을 사용하는 것에 동의합니다. 왜냐하면 "일에 적합한 적절한 도구"가 필요한데, 간단한 작업에는 실제로 간단한 도구만 필요하기 때문입니다.

그러나 오늘날의 컴퓨팅 환경은 근본적으로 다릅니다. 기술적으로는 수평적으로 확장 가능한 서비스를 지원하는 경향이 있으며, 이러한 서비스는 종종 마이크로 서비스 아키텍처, 컨테이너화 및 Kubernetes와 같은 오케스트레이션 도구를 사용하여 운영 환경에서 기계를 수평으로 확장합니다. 또한 캐싱, 로깅, 데이터베이스 및 저장소 솔루션에 의존하는 애플리케이션과 같은 종속 서비스의 수가 증가했습니다(AWS만이 각 소프트웨어 공급 사슬 수직으로 200개 이상의 서비스를 제공한다는 것은 비밀이 아닙니다). 현재는 CI/CD 및 "임시" 환경을 포함하는 더 정교한 개발 프로세스도 사용합니다. 전반적으로, 프로세스는 매우 확대됐으므로 대부분의 대규모 조직에서는 복잡한 시스템을 관리하고 최적화하기 위해 플랫폼 엔지니어와 같은 전문 인력을 고용합니다. - 이런 플랫폼 엔지니어들은 자신들의 환경 변수 관리를 더욱 체계적으로 하기 위해 전용 도구를 사용합니다. 이에 대해서 곧 다루어 보겠습니다.

이전에 언급했듯이, "일에 적합한 적절한 도구"가 필요하며, 특히 오늘날의 환경에서 일의 성격은 확실히 변했습니다. 변수를 관리하는 문맥에서는 대규모 조직에서 복잡한 스택 전반에 걸쳐 조정되는 수천 개 또는 수십만 개의 변수에 대해 빠르게 이야기하게 됩니다. 따라서 이와 관련하여 귀하의 조직 전반에서 사용해야 할 것들에 대해 논의해 보겠습니다, 이미 채택하지 않았다면요.

<div class="content-ad"></div>

# 시크릿 매니저란 무엇이며 환경 변수 관리에서의 역할은 무엇인가요?

익숙하지 않은 분들을 위해, 시크릿 매니저의 개념에 대해 소개해드리겠습니다: 팀이 애플리케이션 구성 및 API 키, 데이터베이스 자격 증명과 같은 민감한 데이터를 관리하는 데 도움이 되는 전용 솔루션으로, “시크릿”을 관리하는 데 사용됩니다. 인기 있는 시크릿 매니저 예시로는 Infisical, HashiCorp Vault, 그리고 AWS Secret Manager, GCP Secret Manager, Azure Key Vault와 같은 주요 클라우드 제공업체가 있습니다.

시크릿 매니저를 사용하는 주된 이점은 중앙 집중화를 통해 시크릿 확산을 막는 능력입니다. 시크릿 확산의 아이디어는 인프라가 다양한 클라이언트(개발자, 애플리케이션, CI/CD 파이프라인 등)를 가질 수 있고 각각이 자체 변수를 필요로 할 때, 많은 변수를 관리해야 하며 이는 보안 위험, 잘못된 구성, 오류의 가능성을 가져온다는 것입니다. 환경 변수의 진실의 원천을 도입함으로써, 시크릿 매니저는 많은 연관된 시나리오를 피할 수 있도록 도와줍니다:

- 변수를 도입하고 업데이트에 대해 다른 팀 멤버에게 알리지 않는다. 그들이 개발을 진행하다가 누락된 변수와 관련된 버그에 부딪히게 된다.
- 코드베이스에 변수를 추가하였지만 제품에는 추가하지 않은 채로 운영에 배포하는 경우, 제품 서비스를 다시 배포한 후 모두에게 잘 작동하지 않는 것을 발견할 수 있습니다.
- 시크릿이 어떤 식으로 유출되었는지 알게 되지만, 사건을 조사하는 능력이 부족하여 그에 대한 다섯 가지 질문에 대답할 수 없게 됩니다.
- 시크릿이 유출되고, 복잡한 인프라 내에서 그 위치가 명확하지 않아 즉시 폐기하지 못하는 경우가 발생하여, 확산이 발생합니다.

<div class="content-ad"></div>

어떤 사람들에게는 관련성이 적을 수도 있지만 매우 흔하고 문제가 되는 상황들도 있습니다:

- 지금까지 100명 넘는 엔지니어로 성장한 당신의 조직은 개발 주기의 다양한 영역에 접근 가능한 엔지니어들이 있습니다. 새로운 엔지니어들이 조직에 합류하고 떠날 때, 민감한 변수에 대한 직원의 접근을 효과적으로 허용/차단하고 모니터링하는 데 어려움을 겪고 있습니다. 더 나쁜 상황은 최근 해고된 직원이 회사의 프로덕션 데이터베이스에 여전히 접근할 수 있다는 것이 밝혀진다는 것입니다 (실제 이야기를 바탕으로 함).
- 당신의 조직은 각 고객을 위해 별도의 멀티텐넌트 전용 클러스터 또는 인스턴스를 제공합니다. 각 클러스터/인스턴스는 자체 환경 변수 세트를 필요로 하며, 100,000명을 넘는 고객들의 변수를 추적하는 데 어려움을 겪고 있습니다.

시크릿 늘어남에 대응하는 것 외에도, 시크릿 매니저는 많은 보안 및 운영상의 이점을 제공합니다: 특권이 있는 엔티티에게 변수에 대한 세밀한 접근을 분할, 주기적으로 변수를 회전하거나 트리거에 의해 회전, 플라이에 대한 일회성 데이터베이스 자격 증명 생성, 레코드 보관을 위해 변수 버전 관리/감사, 등과 같은 기능을 포함합니다.

전반적으로, 시크릿 매니저를 응용 프로그램 구성 및 시크릿에 관한 모든 것을 효과적으로 관리하는 데 도움을 주기 위해 만들어진 목적에 맞는 도구로 생각할 수 있습니다.

<div class="content-ad"></div>

# 모두가 "적절한 도구를 올바른 작업에 사용"을 찾고 있습니다

의견을 조율하기 전에, 적어도 한 가지 사항에 동의할 수 있다고 믿습니다: 우리는 "작업에 적합한 적절한 도구"를 사용하려고 합니다. 이는 간단한 작업을 처리하기 위한 최소한의 오버헤드를 도입하고 실제로 요구되는 복잡한 작업을 처리하기 위한 충분한 도구를 사용하겠다는 것을 의미합니다.

환경 변수 관리의 맥락에서, 효율적이고 안전하게 변수를 관리하는 방법이나 도구를 원합니다. 또한 당사 조직의 가용 자원, 능력, 내부 정책 등의 가변적 제약 조건 하에 이를 수행하길 원합니다; 이는 예산, 인프라 복잡성, 팀 규모, 위협 모델 등을 포함합니다. 다르게 말하면, 환경 변수 관리를 최적화하기 위한 작업인 곳에 "작업에 적합한 적절한 도구"를 원합니다.

# "적절한 도구를 올바른 작업에 사용"은 모두에게 다르게 적용됩니다

<div class="content-ad"></div>

대부분의 사람들이 환경 변수를 가장 잘 관리하는 방법에 대해 의견이 분분한 이유는 "작업" 정의가 다른 사람에게는 다르기 때문이라고 믿습니다. 결과적으로, 일부는 최소한의 추가 도구 사용으로 .env 파일을 사용할 것을 주장하고, 다른 사람들은 시크릿 매니저나 보다 정교한 도구가 필요하다는 데에 동의합니다.

일반적인 상황을 설명하자면, 어떤 사람들에게는 "작업"이 Vercel에 배포된 단일 애플리케이션에 대해 2개의 환경(개발 및 프로덕션)을 가진 50개의 환경 변수를 관리하는 것을 의미할 수 있습니다. 한편, 다른 사람들에게는 "작업"이 수 천 개의 마이크로 서비스를 다중 클라우드 제공업체에 배포하고 온프레미스 구성 요소와 몇 개의 환경(개발, 스테이징, 프로덕션 또는 일회성 환경)에 걸쳐 50,000개 이상의 환경 변수를 조율하는 일을 의미할 수 있습니다. 이 서비스들은 고객을 대상으로 하는 애플리케이션이 아닐 수도 있고, 인프라 스택 내에서 지원 서비스일 수도 있습니다. 예를 들어, 애플리케이션은 데이터베이스, 스토리지, 모니터링/가시성 등을 위해 포스트그레SQL, 레디스, 프로메테우스 등의 서비스 조합에 의존할 수 있습니다.

전자의 경우에는 개발 주기에 시크릿 스프롤(이전에 논의한)이 아직 존재하지 않기 때문에 시크릿 매니저를 도입하는 것이 의미가 없을 수 있습니다. 따라서, 이러한 규모의 팀은 처음부터 굳이 도입할 필요가 없기 때문에 시스템에 오버헤드를 도입하는 것으로 인해 더 높은 재정 및 운영 비용을 부담해야 할 수 있습니다. 그러나 후자의 경우에는 "작업"의 거대한 규모 때문에 운영자들이 시크릿 스프롤과 그로 인한 잠재적인 결과에 직면하게 될 것이며, 이를 적절히 대응하지 않을 경우 심각한 다운타임과 재정적 부담이 발생할 수 있습니다. 수천개의 시크릿에 의존하는 인프라 상황에서는 잘못 관리된 시크릿(누락, 노출된 등)이 심각한 다운타임과 재정적 부담을 유발할 수 있으므로, 시크릿 관리의 확률을 최소화할 수 있는 도구를 도입함으로써 장기적으로 상당한 재정 및 운영 비용을 절감할 수 있습니다. 그러나 일반적으로, 우리는 모두 어느 정도는 클라우드 네이티브 컴퓨팅 시대의 일부이기 때문에, 오늘날의 "작업"은 결국 더 많은 서비스를 도입함으로써 필연적으로 더 복잡해질 것으로 생각됩니다.

오늘날 더 정교한 환경 변수 관리 도구가 필요한 더 구체적인 예시는 현대 은행 인프라에서 발생합니다. 여기서는 핵심 은행 및 대출 발행 등을 포괄하는 시스템이 복잡하며 규정 및 보안 문제로 인해 멀티 클라우드 및 온프레미스로 구성되어 시크릿 스프롤에 직면하는 경우가 일반적입니다. 애플리케이션/서버 구성의 실수가 수백만 명의 은행 고객에게 지불에 영향을 미칠 수 있기 때문에 오류 허용 여부가 낮으며, 그 결과 환경 변수를 잘못 관리하는 가능성을 낮추기 위해 시크릿 매니저를 사용하는 것은 장기적으로 중요한 비용 절감을 이끌어낼 수 있습니다.

<div class="content-ad"></div>

고유한 케이스 스펙트럼에 따라 각각의 요구 사항이 다르므로, "일에 알맞은 적절한 도구"는 작업의 규모와 함께 조절됩니다. 언제나 도구 선택은 조직의 사용 가능한 자원, 능력 및 적응해야하는 정책을 고려해야 합니다.

# 가끔은 "일"로 다른 사람들의 작업을 관리해야 할 때가 있습니다

사용자를 위해 자사의 서비스 뿐만 아니라 멀티 테넌트, 전용 서비스도 관리해야 하는 경우라면 많은 환경 변수를 관리해야 하는 사용 사례가 매우 흔합니다.

한 가지 예를 들어보겠습니다. SaaS 플랫폼을 구축하고 다른 조직에게 판매하는 경우를 상상해보세요. 자신의 플랫폼을 공유 클러스터로 구축하여 노드 간에 적용된 환경 변수를 하나의 세트로 제공하는 대신에, 이제 각 고객에게 플랫폼의 전용 클러스터 또는 인스턴스를 제공하도록 인프라를 변경했다고 가정해 봅시다. 이 새로운 모델에서 각 클러스터는 고유한 환경 변수 세트가 필요합니다. 관리해야 할 조직이 1만개일 경우, 각 조직의 클러스터를 위한 비밀 관리를 체계화하고 자동화할 일정 수준의 구조가 필요하다는 것을 빨리 깨닫게 됩니다.

<div class="content-ad"></div>

보통 비록 특이해 보일지라도, 이 사용 사례는 GitHub, MongoDB, Fly.io 등 다양한 플랫폼에 매우 관련이 높습니다. 예를 들어 Fly.io는 풀 스택 앱 및 데이터베이스를 실행하는 플랫폼으로, 여기에서 플랫폼을 통해 배포된 애플리케이션의 환경 변수/시크릿을 어떻게 관리하는지 공개적으로 문서화하고 있습니다. 이 경우에는 "시크릿이 암호화된 보관소에 저장"되며, "flyctl을 통해 시크릿을 설정하면 시크릿 값이 우리의 API를 통해 전송되어, Fly 앱에 대한 보관소로 기록됩니다. API 서버는 암호화만 할 수 있고, 시크릿 값을 해독할 수는 없습니다. 시크릿 값은 절대 기록되지 않습니다."

이 사용 사례에서 배울 수 있는 점은 전문화된 보관소나 시크릿 매니저를 사용하여 인프라를 프로비저닝한다는 것이며, API(프론트엔드 UI에 연결되는)는 시크릿에 대한 쓰기 액세스만을 갖고 있고, 아마도 Fly.io의 응용 프로그램을 배포하는 인프라 영역은 응용 프로그램을 읽을 수 있는 능력을 가지고 있다는 것입니다. 수백만 개의 앱의 시크릿을 관리하는 데 도움을 주는 동시에, 시크릿 매니저는 기반이 되는 시스템의 보안을 최적화하기 위해 필요한 안전한 세분화된 권한 시스템을 제공합니다.

# 언제 시크릿 매니저를 사용하는 것이 적절한가요?

일반적으로, 조직이 시크릿 매니저가 필요하다고 판단하는 것은 시크릿 매니저 없이 작업하는 것이 고통스러워질 때입니다. 그렇지만 적정한 타이밍을 결정하는 데 도움이 되는 두 가지 지표는 시크릿이 널리 퍼지기 시작하고 회사가 인프라에 더 관심을 기울이기 시작할 때입니다.

<div class="content-ad"></div>

먼저, 알아차릴 수 있었을 것으로 생각되는대로, 시크릿 관리자가 필요한 정도는 개발자, CI/CD 파이프라인, 및 변수에 액세스해야 하는 애플리케이션 등의 클라이언트 수에 많이 의존합니다. 일반적으로 그 숫자가 충분히 많아지고 연관된 시크릿 확산이 문제가 될 때, 혼돈을 완화하기 위해 전용 도구를 도입하고 싶어할 것입니다.

둘째로, 귀하의 조직이 기술 제품을 운영하고 있다고 가정하면, 시크릿 관리자의 필요성은 주로 인프라에 투자하기 시작했을 때 형성됩니다. 이러한 투자의 성격은 구체적인 기능을 구축하는 데보다는 고객 서비스의 원활한 배포, 테스트, 시스템 신뢰성 등을 보장하는 데 더 관련이 있습니다. 5명 또는 20명의 엔지니어가 되었을 때, 언젠가는 DevOps 엔지니어가 투자의 일환으로 팀에 고용될 것입니다. 이 시점에서 엔지니어는 개발 주기에 시크릿 관리를 포함한 모범 사례를 도입하기 시작할 것입니다.

이러한 지표를 넘어서, 모든 규모와 산업의 기업이 시크릿 관리를 실시한다는 사실을 알 수 있습니다. 규모 구상 계획을 시작하는 5~10명의 팀부터 시크릿 확산을 잡기 위해 필요한 1,000명 조직까지, 시크릿 관리자를 사용하는 기업의 수는 많으므로 일찍 채택하는 데 두려워하지 마세요.

# 그런데... 인터넷에서는 시크릿 관리자가 필요 없다고 생각하는 사람도 있습니다.

<div class="content-ad"></div>

솔직히 말해서, 모든 산업 전반에 걸친 소프트웨어 도구 카테고리는 지지자와 반대자가 있습니다. 공급망에서 비밀 관리 소프트웨어를 포함한 다양한 도구 집합이 "필요하지 않다"는 이유로 채택하지 말아야 한다고 주장할 수는 있지만, 그 도구들이 산업 전반에 표준으로 자리 잡고 있다는 점에 대해 당신은 틀렸습니다. 사실은 목적에 특화된 개발자 도구는 소프트웨어 스택 및 개발 프로세스를 개선하고, 제품 제공과 직접적으로 관련이 없는 항목들을 전문적으로 제공하는 업체에게 외부로 전담하여 도와줍니다. 예를 들어,

- 관측 가능한 로깅 도구를 도입하는 것은 불필요하다고 주장할 수 있습니다. 왜냐하면 로그를 자체 호스팅된 오픈 소스 데이터베이스 인스턴스로 전달하고 로그를 직접 쿼리할 수 있기 때문입니다.
- 키 관리 시스템을 도입하는 것이 불필요하다고 주장할 수 있습니다. 왜냐하면 애플리케이션 수준에서 환경 변수로 저장된 키를 사용하여 직접 데이터의 암호화/해독을 할 수 있기 때문입니다.
- 당연히 비밀 관리 도구를 도입하는 것은 불필요하다고 주장할 수 있습니다. 왜냐하면 .env 파일을 사용하거나 소스 컨트롤로 직접 공유 변수의 암호화/해독을 할 수도 있기 때문입니다.

이론적으로는 위의 해결책을 직접 구현하여 사용할 수 있지만, 그럴 경우 각자의 문제점을 안고 있을 것입니다. 주요 장점을 잃거나 프로세스의 최적화를 잃게 되거나, 마지막에는 해당 소프트웨어 스택의 일부에 대해 전용 도구를 채택하는 것보다 해당 부분을 자체적으로 개발하는 데 더 많은 시간을 투자하게 될 것입니다.

비밀 관리의 맥락에서, 이것은 저만의 권고가 아닌 업계 전체에서 채택되는 인프라 실천 방식 및 도구입니다. 비밀 퍼지기가 심각한 문제로 여겨질 때 특정 규모에 도달한 조직이 채택하는 것입니다. 제가 말하는 게 마구잡이 광고가 아니라 그것은 주요 클라우드 제공 업체들이 자사의 비밀 관리 제품을 보유하거나 GitHub나 Ubisoft와 같은 조직들이 어떻게 비밀 관리자를 사용하는지 알아보는 것을 통해 확인할 수 있습니다.

<div class="content-ad"></div>

# 좋은데… 하지만 도구의 안전성은 어떻게 되나요?

당연히 시크릿 관리에 대한 새로운 이용자들은 API 키와 데이터베이스 자격 증명을 신뢰할 수 있는 제3자가 관리할 수도 있는 서비스에 전달하는 것에 대해 유효한 보안 우려가 있습니다. 알다시피, 제3자의 서비스는 여러 액세스 토큰을 한꺼번에 훔치기를 원하는 나쁜 행위자들에게 주로 대상이 될 수 있습니다. 플랫폼 코드에 보안 취약점이 포함되어 있다면 침입당할 수 있고 … 그 이후 일들은 엉망이 될 수 있습니다.

이러한 우려를 고려하여 아래에 몇 가지 생각을 정리해 보았습니다:

- 모든 변수를 하나의 도구에 저장하면 해당 도구가 침해당하면 모든 변수가 유출될 수 있다고 걱정하실 지도 모릅니다. 이는 정당한 우려이지만, 모든 시크릿 매니저는 조직 수준과 제품 수준 모두 최고 수준의 보안을 보장하기 위한 중요한 조치들을 시행한다는 점을 알아야 합니다. 보통 이에는 보안 감사, 인증, 침투 테스트, 특정 기능 (예: 인증/인가 제어, IP 제한과 관련된 토큰 바인딩 제한; TTL; 그리고 더 많은 것들) 등이 포함됩니다. 시크릿 관리 워크플로에 적용할 수 있는 맞춤화와 레이어링이 얼마나 많은지 깜짝 놀랄 것입니다. 마지막으로, 이에 대해 항상 믿을 수 있는 또는 잘 알려진 공급업체를 사용하는 것을 권장합니다. 시크릿 관리는 본질적으로 매우 민감한 영역이므로요.
- 특히 나쁜 행위자들을 위한 주요 대상이 될까봐 걱정하실 수도 있습니다. 이에 대해, Infisical 및 Vault와 같은 오픈 소스 솔루션들을 살펴보는 것을 강력히 추천드립니다. 이러한 솔루션들은 클라우드 인프라나 온프레미스에 배포하여 다른 사람의 대상이 되는 것을 방지할 수 있습니다.
- 마지막으로, 규모 확장에 따른 시크릿 분산과 관련된 위험을 다루는 것이 문제를 완화하는 전용 도구를 사용하는 것보다 훨씬 나을 수 있습니다. 아직 느끼지 못했을지 모르겠지만, 문제가 자연스럽게 발생하면 알게 될 것입니다. 여기서 사용하는 비유는 시크릿 관리자를 패스워드 관리자에 비교하는 것인데, 많은 암호를 관리해야 할 때 더 유용해집니다. 사용하기 전에 여러 서비스에 걸친 약간의 패스워드에 만족했으며 때때로 암호를 잊어버린 적이 있어 암호 복구 과정을 거쳐 서비스 로그인을 재설정했었습니다. 그렇지만, 서로 다른 암호 요구 사항을 충족시키는 각 암호의 수가 증가함에 따라, 각 조합을 수동으로 추척하고 효과적으로 패스워드 분산에 직면하게 되었습니다. 이것은 나에게 비밀번호 관리자에 가입하도록 설득하였고, 그 이후로는 되돌아보지 않았습니다.

<div class="content-ad"></div>

최종적으로, 비밀 노출 문제에 직면할 때 보안 정보가 널리 퍼지는 상황을 고려할 때 비밀 관리자를 사용하는 필요성이 그것이 없는 것에 비해 더 높습니다. 따라서 신뢰할 수 있는 솔루션을 채택하고 권장된 보안 제어를 구현해야 합니다. 해결책 구성이든 개발 주기 전체에서 변수를 최상의 방법으로 검색하는 워크플로 권장사항이든 상관없이요.

# 알겠어. 난 설득됐어. 비밀 관리자를 어떻게 사용하는지 보여줘, 코드 좀 줘봐

일을 간단하게 유지하기 위해, Infisical을 사용할 거야. 이 오픈 소스 비밀 관리 플랫폼을 사용할 텐데. Vault나 AWS Parameter Store와 같은 다른 비밀 관리자도 사용할 수 있는데, Infisical을 선택한 이유는 빠르게 구동할 수 있고, 자체 인프라에서 호스팅할 수 있으며 잘 문서화되어 있기 때문이야.

![그림](/assets/img/2024-06-23-Itstimetodeprecatetheenvfile_1.png)

<div class="content-ad"></div>

어쨌든, 이 간단한 예제를 통해 런타임에 환경 변수를 가져오기 위해 Node SDK를 사용할 것입니다. 그러나 환경 변수를 API 호출을 통해 가져오거나, 다른 SDK(파이썬, 자바, C# 등), CLI, 쿠버네티스 오퍼레이터, 인피지컬 에이전트 등의 다른 메서드도 사용할 수 있습니다. 이는 당신의 스택 및 개발 주기와 같은 여러 요인에 따라 당신에게 더 적합할 수 있습니다.

그럼 시작해봅시다.

먼저, 프로젝트에 패키지를 설치하세요:

```js
$ npm install @infisical/sdk
```

<div class="content-ad"></div>

다음으로 SDK를 가져와서 기계 식별 유니버설 인증 자격증명으로 클라이언트 인스턴스를 생성하세요.

```js
import { InfisicalClient, LogLevel } from "@infisical/sdk";

const client = new InfisicalClient({
    clientId: "YOUR_CLIENT_ID",
    clientSecret: "YOUR_CLIENT_SECRET",
    logLevel: LogLevel.Error
});
```

최적의 성능을 보장하기 위해 클라이언트의 단일 인스턴스를 생성하고 전체 앱에서 사용하도록 내보내는 것을 권장합니다. SDK는 주기적으로 업데이트될 수 있는 비밀을 캐시할 수 있기 때문에 불필요한 호출을 줄이고, 이 내장 캐싱은 환경 변수를 대규모로 동기화하는 것을 원활하게 만듭니다.

이제 클라이언트를 사용하여 애플리케이션에 필요한 비밀을 필요에 따라 가져올 수 있습니다:

<div class="content-ad"></div>

```js
app.get("/", async (req, res) => {
    // 접근 값 설정

    const name = await client.getSecret({
        environment: "dev",
        projectId: "PROJECT_ID",
        path: "/",
        secretName: "NAME"
    });

    res.send(`안녕하세요! 제 이름은: ${name.secretValue}`);
});
```

이제 애플리케이션이 환경 변수를 필요로 할 때, 필요한 환경 변수를 Infisical로부터 요청할 수 있습니다. 이제 Node 애플리케이션의 모든 환경 변수를 한 곳에서 확인하고 누락된 환경 변수를 방지할 수 있습니다.

이전에 언급했듯이, 이는 런타임 중에 애플리케이션을 위한 변수를 가져오기 위해 시크릿 매니저를 사용하는 방법의 미니멀한 예시입니다. 사용 사례에 따라, 또 다른 방법으로 시크릿 매니저와 프로그래밍 방식으로 상호 작용하는 것이 더 적합할 수 있습니다. 어떠한 경우에도, 이에 관심이 있다면 여기서 Infisical 문서를 참고해야 합니다.

# 결론


<div class="content-ad"></div>

시크릿 매니저는 인프라스트럭처 공간에 처음 입문하는 사람들에게 종종 오해받는 도구지만, 복잡한 인프라 작업을 간소화하고 여러 변수에 의존하는 조직에게 매우 관련이 있습니다. 클라우드 네이티브 컴퓨팅 시대에는 전형적인 인프라가 수백 개 이상의 분산된 서비스 및 복제로 구성되어 있기 때문에, 작업에 적합한 도구를 배우고 사용하는 것이 중요합니다.