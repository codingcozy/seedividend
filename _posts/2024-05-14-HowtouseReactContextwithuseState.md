---
title: "리액트 Context와 useState 함께 사용하는 방법"
description: ""
coverImage: "/assets/img/2024-05-14-HowtouseReactContextwithuseState_0.png"
date: 2024-05-14 11:32
ogImage: 
  url: /assets/img/2024-05-14-HowtouseReactContextwithuseState_0.png
tag: Tech
originalTitle: "How to use React Context with useState"
link: "https://medium.com/comsystoreply/how-to-use-react-context-with-usestate-c8ae4fe72fb9"
---


래엑트 앱에서 props를 도대체 어디서 사용해야 하는지 지친 적이 있나요? Redux에 대한 대안을 찾고 계신가요? 자식 컴포넌트가 props를 사용하지 않고 계속해서 전달하고 있나요? 더 나은 방법이 여기 있어요!

![이미지](/assets/img/2024-05-14-HowtouseReactContextwithuseState_0.png)

필수 요구 사항: props, state, 컴포넌트 및 훅에 대한 기본적인 React 지식이 필요합니다. 더불어 TypeScript 지식도 약간 필요합니다. 이 예시에서는 함수형 컴포넌트를 사용할 것입니다. (그리고 제 동료 요한네스가 쓴 React 컴포넌트 작성을 위한 고려 사항 기사도 확인해보세요)

## 개요



1. 문제와 Context 사용 시기
2. 쉬운 구현과 기본 사항
3. 더 현실적인 예제
4. 고려할 사항

# 1. 문제와 Context 사용 시기

Context를 사용하는 가장 흔한 문제 또는 고려 사항 중 하나는 prop drilling 문제입니다. 이 문제를 설명하기 위해 음식 주문 앱을 예시로 사용하겠습니다. 새롭고 멋진 음식 주문 앱을 작성했다고 상상해보세요. 앱에는 리스트에 표시하고 싶은 음식 항목이 있습니다. 각 음식 항목에는 쇼핑 카트에 항목을 추가할 수 있는 카운터가 있습니다. 주문하기 전에 음식의 양을 보여주는 쇼핑 카트 컴포넌트를 작성했다고 가정해 보겠습니다. 이 앱의 컴포넌트 트리는 다음과 유사할 수 있습니다:

![그림](/assets/img/2024-05-14-HowtouseReactContextwithuseState_1.png)



음식 항목의 현재 개수를 추적하는 방법을 간단히 보여주는 코드 예제가 있어요. 계수 상태는 FoodCounter 및 FoodSummary 구성 요소에 필요하기 때문에 트리 상단에 있어요.

우리는 상태를 전체 트리를 통해 prop으로 전달하고 있는 것을 알 수 있어요. FoodItem 구성 요소에서는 심지어 상태가 필요하지 않을 수도 있지만, 우리는 단지 FoodCounter 구성 요소에 전달하기 위해 prop을 전달하고 있어요. 이것이 프롭 드릴링 문제에 관한 것이죠. (코드 예제에 표시되어 있지 않은 ShoppingCart 및 FoodSummary 구성 요소에서도 비슷한 일이 발생할 수 있어요)

이렇게 하면 구성 요소가 혼잡해지고, 다른 사람이 코드를 읽는 데 어려워질 수 있어요. 특히 여러 속성을 전달하기 시작하면 더 나빠질 수도 있어요. 그러나 우리가 원하는 것은 구성 요소를 깔끔하게 유지하고 실제 필요한 곳에만 상태를 갖도록 하는 것이에요. 이때 React Context가 도움을 줄 거예요.

# 2. 쉬운 구현으로 기초를 익히기



자, 이 예제를 조금 더 자세히 살펴볼게요. 모든 구성 요소를 'Component'로 이름을 변경해서 우리가 중점을 두어야 할 중요한 부분, 즉 Context를 구축하는 작업에 집중하도록 할 거에요. 우리는 Context, Context Provider 및 Context Consumer를 생성하여 상태를 다르게 관리할 거에요.

## 세 가지 주요 구성 요소

![이미지](/assets/img/2024-05-14-HowtouseReactContextwithuseState_2.png)

위 이미지에서 보다 싶이, 세 가지 주요 구성 요소는 Context, Provider 및 Consumer이기 때문에 우리는 다음을 해야해요:



- 컨텍스트 생성하기
- 부모 컴포넌트를 Provider로 감싸기
- 컨텍스트 사용하기

### 1. 컨텍스트 생성하기

코드 예시에서 보는 것처럼 React에서 컨텍스트를 생성하는 것은 정말 쉽습니다. createContext 함수를 호출하기만 하면 됩니다. 선택적으로 기본값을 전달할 수 있습니다. 이 경우에는 "defaultValue"라는 문자열을 전달했습니다.

### 2. 부모 컴포넌트를 Provider로 감싸기



부모 컴포넌트에서는 반환하는 요소들을 우리의 Context로 감쌀 수 있습니다. 구체적으로, MyContext의 Provider 속성으로 MyParentComponent를 감싸고 있습니다. 이는 우리가 React에서 Context를 생성한 후에 얻는 기본 속성입니다. 다른 파일에서 Context를 생성했다면 쉽게 여기에서 불러와서 사용할 수 있습니다. 예제에서 보시다시피 Provider는 React에서 일반 컴포넌트처럼 사용할 수 있습니다.

게다가, Context Provider 컴포넌트에는 value 속성이 함께 제공됩니다. 우리는 이를 사용하여 마음에 드는 어떤 값을 전달할 수 있습니다. 이 경우 "My Context Value" 문자열을 만들어서 Context Provider에 전달해 보겠습니다.

## 3. Context를 사용하고 값을 활용하기

MyComponent 내부나 트리 아래의 다른 자식 컴포넌트에서 이를 사용할 수 있습니다:



그래서 이제 우리는 MyComponent에서 또는 그 하위 컴포넌트 중 어디에서든 Context를 직접 사용할 수 있습니다. Context를 사용하려면 useContext 훅을 호출하고 Context(MyContext)를 인수로 전달하면 됩니다. 이렇게 하면 Provider에서 제공한 값을 얻을 수 있습니다. 이름이 어디에서 유래했는지 이제 아시겠죠 😉

값을 얻으면 다른 종류의 프롭(prop)이나 상태 변수와 마찬가지로 사용할 수 있습니다. 여기서는 그 값을 단락 안에 반환하기만 합니다.

## 중요: React가 어떻게 해당 값 사용 여부를 알 수 있을까요?

# 3. 좀 더 현실적인 예제



첫 번째 예는 React Context 개념을 설명하기 위해 범용적이고 최소한의 내용이었습니다. 이제 실제 응용 프로그램에서 찾을 수있는 것과 훨씬 가까운 예제를 살펴볼 것입니다. 예를 들어, 사용자가 앱에서 가입하는 온보딩 또는 등록 흐름을 사용할 것입니다.

이 예제에서 TypeScript를 사용할 것입니다. 또한 useState 훅을 사용할 Provider 컴포넌트를 직접 만들 것입니다. 온보딩 흐름에는 여러 단계가 있어 각 단계 간에 데이터를 공유하고 요약 화면에 데이터를 표시하려는 경우를 상상해보세요. 모든 데이터를 props로 전달하고 싶지 않기 때문에 OnboardingContext를 사용할 것입니다.

우선, 사용자 이름 상태와 사용자 이름 상태를 업데이트하는 setUsername 액션을 가진 Context를 위한 인터페이스를 생성합니다. 여기에서는 단순화를 위해 사용자 이름만 사용합니다. 물론 메일 주소나 사용자의 생일과 같은 속성을 추가할 수 있습니다.

이후에 이전과 같이 Context를 생성하며, 이는 OnboardingContextValue 또는 undefined 유형이 될 수 있습니다. 기본값으로 undefined를 전달합니다. 이제 사용자 정의 Provider 컴포넌트를 만들어봅시다.



여기서는 평소처럼 useState 훅을 호출하고 사용자 이름과 setUsername 함수를 언팩합니다. 그런 다음 모든 하위 구성 요소를 사용하여 우리의 온보딩 컨텍스트 프로바이더를 반환합니다. 값으로는 사용자 이름과 setUsername 함수만 전달합니다. 물론, 이 시점에서 더 많은 상태를 추가하고 값을 프로바이더에 전달할 수도 있습니다. 아마도 이미 우리가 컨텍스트 생성 시 기본 값으로 undefined를 전달한 이유에 궁금증을 품었을 수도 있습니다. 여기에 그 답이 있습니다:

컨텍스트가 생성되고 일치하는 프로바이더를 찾지 못할 때 undefined가 기본 값으로 사용됩니다. 이는 우리에게 에러를 throw해줍니다. 실제로 이 에러가 발생하길 원합니다. 왜냐하면 우리는 컨텍스트에서 기본 값을 사용하고 싶지 않기 때문입니다. 우리는 커스텀 프로바이더 컴포넌트에서 정의한 상태를 사용하려고 합니다. 그러나 온보딩 컨텍스트가 undefined인 경우 부모 컴포넌트를 커스텀 프로바이더로 감싸놓지 않았을 수도 있습니다.

이 문제를 해결하기 위해 부모 컴포넌트를 커스텀 프로바이더로 감싸놓습니다:

상태 값들을 사용하려면 하위 구성 요소 중 하나에서 커스텀 훅을 사용할 수 있습니다. 그냥 사용자 이름과 setUsername 함수를 언팩하면 됩니다. 이제 이들을 다른 상태 값이나 상태 액션처럼 사용할 수 있습니다. 마치 이 컴포넌트에서 useState 훅을 직접 사용했을 때와 유사합니다. 이렇게 하면 단일 컴포넌트에서 상태를 컨텍스트로 쉽게 옮기는 것도 가능합니다.



# 4. 고려해야 할 사항

코드베이스에 Context를 도입하기 전에 고려해야 할 몇 가지 사항이 있습니다. 먼저, 데이터에 대해 고민해야 합니다. 컴포넌트에 어떤 데이터가 필요한가요? 그리고 이 데이터가 정확히 어디에 필요한가요? 이를 통해 일반적으로 전체 응용 프로그램을 더 잘 이해할 수 있습니다. 이는 또한 어떤 데이터가 어울리는지, 그리고 데이터가 정말 공유 Context에 있어야 하는지에 대한것도 포함합니다.

이후, 다음 질문을 통해 계속할 수 있습니다. "현재 사용 중인 상태는 무엇인가요?" 여전히 이러한 상태가 필요할 수 있지만, 이를 Context로 옮길 수도 있습니다. 어떤 상태를 Context에 넣고 싶은지 스스로에게 묻고, 그 상태가 단 하나의 컴포넌트에만 필요하기 때문에 Context에 필요하지 않은 상태도 파악해야 합니다. 또한 상태를 어떻게 변경하는지도 고민해보세요. set state 함수를 Context로 이동할 수 있지만, 사용자 지정 처리기까지 이동하는 등 더 나아간 방향으로 진행할 수도 있습니다.

마지막으로, prop drilling이 정말 큰 문제인지 스스로에게 물어보아야 합니다. Context를 생성하면 특정한 오버헤드가 발생합니다. 이는 응용 프로그램을 변경하거나 리팩토링하는 데 어렵게 만들 수 있습니다. 예를 들어, Context는 컴포넌트를 테스트하기 어렵게 만들 수 있습니다. 컴포넌트에 모킹된 props를 전달하는 것이 Context로 컴포넌트를 감싼 사용자 지정 테스트 렌더 함수를 작성하는 것보다 쉽습니다. Context의 오버헤드가 props를 전달하는 작은 번거로움만큼 가치가 있는지 스스로에게 물어보세요.



컨텍스트를 사용하면 컴포넌트 간 데이터 흐름을 이해하기 어려울 수 있어요. 하지만 프롭스를 사용하면 어떤 데이터가 컴포넌트로 들어오고 나가는지 항상 명확하게 알 수 있어요. 컨텍스트를 사용하면 실제 데이터가 어디에서 오는지 찾기 위해 조사를 먼저 해야할 수도 있어요.

## 요약하자면

우리가 하는 일을 좋아하시나요? 함께 하고 싶으신가요? 저희의 최신 채용정보를 확인해보세요: https://www.comsystoreply.com/career

이 블로그 포스트는 Comsysto Reply GmbH에서 발행되었습니다.