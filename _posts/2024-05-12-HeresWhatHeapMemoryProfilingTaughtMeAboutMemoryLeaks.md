---
title: "힙 메모리 프로파일링이 나에게 메모리 누수에 대해 가르쳐준 것"
description: ""
coverImage: "/assets/img/2024-05-12-HeresWhatHeapMemoryProfilingTaughtMeAboutMemoryLeaks_0.png"
date: 2024-05-12 23:53
ogImage: 
  url: /assets/img/2024-05-12-HeresWhatHeapMemoryProfilingTaughtMeAboutMemoryLeaks_0.png
tag: Tech
originalTitle: "Here’s What Heap Memory Profiling Taught Me About Memory Leaks"
link: "https://medium.com/javascript-in-plain-english/heres-what-the-heap-memory-profiling-taught-me-about-memory-leaks-1c7c53388aa1"
---


![메모리 누수에 대한 Heap 메모리 프로파일링이 가르쳐 준 것](/assets/img/2024-05-12-HeresWhatHeapMemoryProfilingTaughtMeAboutMemoryLeaks_0.png)

웹 개발자로서, 보통은 JavaScript(사실 TypeScript)로 코딩을 즐겨하며, 애플리케이션이 브라우저에서 실행될 때 관리되는 메모리 관리와 가비지 수집의 복잡성에 무감각하게 살아갑니다. 메모리 관리? 응, 그건 브라우저가 걱정해야 하는 문제야!

가끔은 사소한 코드 변경으로 우리의 한 때는 원활하게 작동하던 애플리케이션이 녹슬은 보트처럼 갑자기 물고기처럼 움직이기 시작합니다. 느린 반응, 응달한 인터페이스, 그리고 두려운 충돌이 제 친절치 않은 동반자가 되곤 했습니다. 그래서 가끔씩, 나는 브라우저 JavaScript 메모리 개발 도구 패널의 신비한 동굴 속에서 자신을 발견하곤 합니다.

개발 도구 메모리 탭의 깊은 곳으로 다시 돌아가려면 언제나 어려운 작업이 필요합니다. 거의 갈 일이 없는 이곳을 방문하려면 상기시키기가 언제나 필요하죠. 리프레셔를 통과한 후, 내 시간을 거기서 즐기기 시작했습니다. 거기에는 애플리케이션의 효율성 또는 종종 비효율성, 그리고 숨겨진 메모리 누수에 대한 통찰과 비밀이 가득한 지식의 보물창고가 있습니다.



잠시만요, 브라우저 메모리 패널을 빠르게 살펴보며 만들어지는 골드를 발굴해 보겠습니다. Chrome DevTools에서 자바스크립트 힙과 메모리 할당의 신비를 풀기 위해 함께 여행을 떠날 준비가 되셨나요?

# 힙이란?

자바스크립트 힙은 웹 브라우저 내부의 특정 메모리 공간을 가리키며, 자바스크립트 코드에서 사용하는 데이터를 저장하는 데 전용되어 있습니다. 이는 웹 애플리케이션 실행에 특별히 예약된 대규모 메모리 풀로 이해하시면 됩니다.

- 런타임 중에 자바스크립트 코드에 의해 할당된 동적 데이터를 저장합니다. 이에는 객체, 배열, 함수 및 스크립트에서 생성된 다른 데이터 구조가 포함됩니다.
- 스택에 있는 변수(숫자나 문자열과 같은 고정 크기 데이터에 사용)와는 달리, 힙은 코드의 필요에 따라 유연하게 메모리를 할당할 수 있습니다.
- 자바스크립트 엔진은 힙을 자동으로 관리하여 새로운 객체에 대해 메모리를 할당하고 사용되지 않는 것들에 대해서는 가비지 수집(garbage collection)이라는 과정을 통해 메모리를 회수합니다.



우리는 다행히도 코드에서 직접 메모리 할당 또는 해제를 관리하지 않습니다. 하지만 힙이 작동하는 방식을 이해하면 더 효율적이고 성능이 우수한 JavaScript 코드를 작성하는 데 도움이 될 수 있어요.

## 우리는 공간을 세 가지 부분으로 나눌 수 있어요

- 살아 있는 객체: 현재 코드에서 사용 중인 객체로 힙 공간을 차지하고 있어요.
- 죽은 객체: 코드에서 더는 필요하지 않지만 쓰레기 수집에 의해 회수되지 않은 객체들이에요.
- 빈 공간: 새로운 객체를 할당하기 위해 사용 가능한 사용되지 않은 메모리공간이에요.

## 이 정보를 활용해서 무엇을 할 수 있을까요?



- 힙(heap)이 어떻게 작동하는지 이해하면 효율적인 메모리 관리가 가능해지며, 이는 성능과 안정성에 직접적으로 영향을 미칩니다.
- 더 이상 필요하지 않은 객체가 의도하지 않게 보관되는 메모리 누수는 메모리 고갈, 느려짐 및 최종적으로 충돌로 이어질 수 있습니다. (오늘 이 글을 쓰게 된 동기입니다)

자바스크립트 힙은 웹 애플리케이션의 메모리를 관리하는 데 중요한 역할을 합니다. 용도, 관리 전략 및 구성 요소를 이해함으로써, 보다 숙련되고 책임감 있는 개발자가 되어 효율적이고 성능이 우수한 코드를 작성하여 부드러운 사용자 경험을 제공할 수 있습니다.

# 메모리 사용 분석을 위한 메모리 탭 활용 방법

힙 스냅샷



- 특정 시점에 전체 JavaScript 힙에 대한 스냅샷을 촬영할 수 있게 해줘요. 메모리 사용량을 캡처하는 것과 같아요. 살아있는 모든 객체와 그들의 관계를 포함하고 있어요.
- 다른 애플리케이션 상태 간의 스냅샷을 비교하여 메모리 누수를 식별할 수 있어요.
- 다른 객체 유형이 사용하는 메모리의 전반적인 분포를 분석할 수 있어요.
- 불필요한 데이터를 유지하고 있는 이유를 이해하기 위해 개별 객체와 속성을 검사할 수 있어요.

![이미지 파일](/assets/img/2024-05-12-HeresWhatHeapMemoryProfilingTaughtMeAboutMemoryLeaks_1.png )

![이미지 파일](/assets/img/2024-05-12-HeresWhatHeapMemoryProfilingTaughtMeAboutMemoryLeaks_2.png)

상호작용해보세요! 애플리케이션의 작업 흐름의 다른 단계에서 스냅샷을 찍어 메모리 사용량을 비교하고 잠재적인 누출을 식별하세요. "스냅샷 찍기" 버튼을 내일이 없는 것처럼 클릭해보세요!



## 타임라인에 할당 계측

이 옵션은 웹 애플리케이션에서 메모리 사용량을 분석하는 강력한 방법을 제공합니다. 힙 스냅숏(Heap Snapshots)과 할당 샘플링(Allocation Sampling)의 측면을 결합하여 애플리케이션 실행에 따른 메모리 할당 및 해제 이벤트를 자세히 보여줍니다.

- 일정 간격으로 JavaScript 힙의 스냅숏과 해당 스냏텟들 사이에 할당 및 해제된 모든 객체에 대한 정보를 기록합니다.
- 객체 생성(메모리 할당 이벤트) 및 객체 해제(메모리 해제 이벤트)를 나타내는 표식이 있는 시각적 타임라인을 생성합니다.

![이미지](/assets/img/2024-05-12-HeresWhatHeapMemoryProfilingTaughtMeAboutMemoryLeaks_3.png)



- 특정 사용자 상호 작용이나 코드 실행 중에 메모리 사용량이 어떻게 변화하는지 확인해 보세요.
- 할당된 메모리를 정리하는 쓰레기 수집 주기의 효과를 분석하세요.

![image](/assets/img/2024-05-12-HeresWhatHeapMemoryProfilingTaughtMeAboutMemoryLeaks_4.png)

- 시간이 지남에 따라 메모리가 어떻게 변하는지 명확하게 시각적으로 표현하여 잠재적인 문제를 식별하기가 더 쉬워집니다.

전반적으로 할당 기기 프로필 형식은 응용 프로그램의 메모리 사용량에 대한 깊은 통찰력을 얻을 수 있는 소중한 도구이며, 잠재적인 메모리 누수를 식별하는 데 도움이 됩니다. 메모리 변화를 이해하는 데 중요한 복잡한 응용 프로그램이나 상황에 특히 유용합니다.



## 할당 샘플링

프로필은 애플리케이션 실행 중 특정 기간 동안 새로 할당된 JavaScript 객체에 대한 정보를 기록합니다. 다른 프로필 유형과 달리 전체 힙의 스냅샷을 캡처하지는 않지만 대신 시간 경과에 따른 메모리 할당 패턴을 추적하는 데 초점을 맞춥니다.

- 메모리 핫스팟 식별: 가장 많은 메모리 할당을 담당하는 애플리케이션 내 함수 또는 코드 블록을 파악하는 데 도움이 됩니다. 이를 통해 코드의 어느 부분이 전체 메모리 사용량에 가장 크게 기여하는지 이해할 수 있습니다.
- 시간별 메모리 변화 분석: 기간 동안 데이터를 수집하여 특정 사용자 상호작용이나 코드 실행 중 메모리 사용량이 어떻게 변하는지 볼 수 있습니다. 이를 통해 할당 증가와 관련된 메모리 누수나 병목 현상을 식별할 수 있습니다.
- 빈번한 가비지 컬렉션 진단: 애플리케이션이 빈번한 가비지 컬렉션 주기를 겪는 경우, 할당 샘플링을 통해 가장 수명이 짧은 객체를 생성하는 코드 섹션이 어디인지 이해할 수 있습니다. 이를 통해 불필요한 할당을 줄이고 가비지 컬렉션 효율성을 향상시킬 수 있습니다.

<img src="/assets/img/2024-05-12-HeresWhatHeapMemoryProfilingTaughtMeAboutMemoryLeaks_5.png" />



<img src="/assets/img/2024-05-12-HeresWhatHeapMemoryProfilingTaughtMeAboutMemoryLeaks_6.png" />

## 할당 샘플링 프로필에 대한 추가 참고 사항

- 전체 힙을 표시하지 않습니다: "힙 스냅샷"과 달리 특정 시점에 전체 JavaScript 힙을 캡처하지 않습니다. 이는 누수 가능성이 있는 객체를 직접 식별할 수 없지만 어느 영역이 많이 할당되는지만 볼 수 있음을 의미합니다.
- 자원을 많이 소비할 수 있습니다: 많은 양의 할당된 객체를 샘플링하는 것은 응용 프로그램 실행에 약간의 부하를 추가합니다. 성능에 영향을 미치지 않도록 짧은 기간 동안 신중하게 사용하십시오.

할당 샘플링 프로필은 JavaScript 애플리케이션에서 메모리 할당 패턴을 프로파일링하는 데 유용한 도구입니다. 높은 메모리 사용을 가진 코드 영역을 식별하고, 시간 경과에 따른 메모리 변화를 이해하며, 빈번한 가비지 수집과 관련된 잠재적인 성능 문제를 진단하는 데 도움이 됩니다.



우리 Memory Tab 프로필 중 "Heap Snapshots" 또는 "Allocation instrumentation on timeline"과 같은 다른 프로필을 대체하려는 것이 아닙니다. 서로 다른 통찰력을 제공하는 다른 도구를 선택하세요. 특정한 요구사항과 메모리 분석 목표에 따라 올바른 도구를 선택해야 합니다.

힙과 메모리 프로파일링을 탐구한 결과, JavaScript 응용 프로그램 내의 메모리 관리 세계를 탐구하기 흥미롭고 비교적 편안한 곳이라는 것을 발견했습니다.

메모리 누수는 때때로 발생하는 것조차 모르기 어려울 뿐 아니라 어플리케이션이 수십만 줄 또는 수백만 줄의 코드로 이루어진 상황에서 어디서 발생했는지 정확히 파악하는 것이 어렵습니다. 실수로 유지된 객체에 대한 의도하지 않은 참조로 인한 메모리 누수는 메모리 고갈, 성능 저하 및 최종적으로 어플리케이션 충돌과 같은 여러 문제를 야기할 수 있습니다. 이는 JavaScript 힙 안에서 메모리가 어떻게 할당되고 사용되며 회수되는지를 이해하는 것이 상당히 중요하다는 것을 강조합니다.

이러한 지식을 바탕으로 메모리 누수를 효과적으로 식별하고 해결하는 방법 뿐만 아니라 더 효율적이고 성능이 우수한 코드를 설계하는 방법도 익혔습니다. 브라우저의 JavaScript 힙을 탐험하는 여정은 계몽적이고 능력을 부여하는 경험이 되었습니다.




만약 이 콘텐츠를 즐겼고 이러한 노력을 지원하고 싶다면 여기를 방문해주세요: https://ko-fi.com/jacobmacinnis.

# 쉽고 날 것의 영어로 🚀

In Plain English 커뮤니티의 일원이 되어 주셔서 감사합니다! 떠나시기 전에:

- 반드시 박수를 보내고 작가를 팔로우해주세요 👏️️
- 팔로우하기: X | LinkedIn | YouTube | Discord | Newsletter
- 다른 플랫폼 방문하기: Stackademic | CoFeed | Venture | Cubed
- PlainEnglish.io 에서 더 많은 콘텐츠 확인하기
